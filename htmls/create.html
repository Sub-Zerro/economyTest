<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Создание нового теста</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400&display=swap" rel="stylesheet">
<style>
    *{
        background-color: #45075c;
    }
    h1, h2 {
        font-family: 'Comfortaa';
        border-radius: 20px;
        width: 50%;
        margin-left: auto;
        margin-right: auto;   
    }
    h1, input, button, #que {
        box-shadow: 10px 10px black;
    }
    h1 {
        width: 600px;
        height: 200px;
        display: flex;
        text-align: center;
        align-items: center;
        background-color: #4762e5;
    }
    h2 {
        height: 100px;
        text-align: center;
        justify-content: center;
        align-items: center;
        background-color: #edcb51;
        display: flex;
        font-size: 40px;
        z-index: 2;
        position: relative;
        width: 50.5%;

    }
    body {
        text-align: center;
        justify-content: center;
        align-items: center;
    }
    input {
        background-color: #38b943;
        border-radius: 10px;
        height: 100px;
        width: 50%;
        border-bottom-left-radius: 20px;
        border-bottom-right-radius: 20px;
        outline: 0 !important;
        margin-top: -15%;
        z-index: 1;
        position: relative;
        font-size: 30px;
    }
    #que {
        background-color: #299dcf;
        margin-bottom: 75px;
    }
    #q_i {
        background-color: #38b943;
        border-radius: 20px;
        margin-bottom: 50px;
    }
    .qu {
        box-shadow: 10px 0px black;
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 0;
        width: 50.2%;
    }
    button {
        background-color: #e57747;
        height: 150px;
        width: 2000px;
        font-size: 40px;
        border-radius: 20px;
        font-family: 'Comfortaa';
        width: 300px;
    }
    .add {
        margin-right: 5%;
        margin-left: 30%;
        float: left;
        margin-top: 20px;
        margin-left: 17%;
    }
    .end {
        float: left;
        margin-top: 0px;
    }
    .check {

    }
</style>
</head>
<body>
    <h1>Создание нового теста. Заполните поля, если есть лишний ответ - просто оставьте его пустым</h1>


    <h2 id="que">Вопрос</h2>
    <input type="text" id="q_i">
    <h2 class="qu">Вариант ответа 1</h2>
    <input type="text">
    <h2 class="qu">Вариант ответа 2</h2>
    <input type="text">
    <h2 class="qu">Вариант ответа 3</h2>
    <input type="text">
    <h2 class="qu">Вариант ответа 4</h2>
    <input type="text">
    <h2 class="qu">Порядковый номер правильного ответа</h2>
    <input type="text" id="last_input">
    <br>
    <button class="add">Добавить вопрос</button>
    <button class="check">Посмотреть вопросы</button>
    <button class="end">Закончить и отправить</button>

    <script>
        let inputs = document.querySelectorAll('input');
        let btn = document.querySelector('.add');
        let end_btn = document.querySelector('.end');
        let check_btn = document.querySelector('.check');
        let right_str = '';
        let arr = [];


        btn.addEventListener('click', ()=>{
            (async ()=>{
                await arr.push([
                    inputs[0].value,
                    inputs[1].value,
                    inputs[2].value,
                    inputs[3].value,
                    inputs[4].value,
                    inputs[5].value
                ]);
                right_str += `${inputs[5].value}`;

                //await add_div(inputs[0].value, inputs[1].value, inputs[2].value, inputs[3].value, inputs[4].value);

                console.log(arr);
                console.log(right_str);

                for(let i = 0; i < inputs.length; i++){
                    inputs[i].value = '';
                }
            })()

        })

        end_btn.addEventListener('click', ()=>{
            send_to_server(arr, right_str);
        })

        check_btn.addEventListener('click', ()=>{
            let str = '';
            for (let i = 0; i < arr.length; i++){
                str += `
                    Вопрос: ${arr[i][0]}
                    |
                    Варианты ответа:
                    1) ${arr[i][1]}
                    2) ${arr[i][2]}
                    3) ${arr[i][3] ? arr[i][3] : '-'}
                    3) ${arr[i][4] ? arr[i][4] : '-'}
                    |
                    Праильный вариант ответа: ${arr[i][5]}



                `
            }

            alert(str);
        })





        function add_div(q, o1, o2, o3, o4){
            let arr = [q, o1, o2, o3, o4];
            let div = document.createElement('ul');
            //div.className = `${num}`;
            document.body.appendChild(div);

            //let new_div = document.querySelector(`.${num}`);
            let newlistItem;
            for(let i = 0; i < 5; i++){
                newlistItem = document.createElement('li');
                newlistItem.textContent = arr[i];
                div.appendChild(newlistItem);
            }
        }

        function send_to_server(arr, str){
            fetch("/create", {
                method: "post",
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                //make sure to serialize your JSON body
                body: JSON.stringify({
                    arr: arr,
                    str: str
                })
            }).then((res)=>{
                res.json().then(post => document.write(`Квиз записан, его номер - ${post.otv}`));
            })
        }

    </script>

</body>
</html>
